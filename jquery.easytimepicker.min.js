/* jQuery EasyTimepicker v0.1
 * https://github.com/BruceHill/EasyTimepicker
 *
 * Copyright (c) 2011 Bruce Hill
 *
 * Dual licensed under the MIT and GPL licenses.
 */

(function(f){var i=new Date().getTime();var s=1439;var n=1440;var l="picker_";var b="easytimepicker-haspicker";var j={interval:15,display24Hour:false,value24Hour:true,nativeMenu:true};var r=f.fn.val;f.fn.val=function(w){if(typeof w!="undefined"){var x=this.get(0);if(x&&x.className.indexOf(b)!=-1){g(x,w);return this}else{return r.call(this,w)}}return r.call(this)};function m(w){return(w<10)?"0"+w:w}function a(z,y){var w=typeof z;if(w=="number"){return z}var x=parseInt(z,10);if(x!=NaN){return x}return y}function t(y,x){var w=typeof y;if(w=="boolean"){return y}if(w=="string"){return(y.toLowerCase()=="true")}return x}function p(x){if(typeof x!="string"||x.length!=5){return x}var y=x.split(":");var w=parseInt(y[0],10);return((w>12)?m(w-12):y[0])+":"+y[1]+" "+((w>11)?"PM":"AM")}function c(y){y=y.replace(" ","");var w=(y.substr(5,2).toLowerCase()=="pm");var x=parseInt(y.substr(0,2),10);if(x==NaN){return null}return m((w&&x!=12)?(x+12):x)+y.substr(2,3)}function d(x){var w=Math.floor(x/60);var y=x%60;return m(w)+":"+m(y)}function u(x,w){return(w)?x:p(x)}function o(w){var x=w||j;x.interval=a(x.interval||j.interval,j.interval);x.interval=(x.interval<1||x.interval>n)?j.interval:x.interval;x.nativeMenu=t(x.nativeMenu||j.nativeMenu,j.nativeMenu);x.display24Hour=t(x.display24Hour||j.display24Hour,j.display24Hour);x.value24Hour=t(x.value24Hour||j.value24Hour,j.value24Hour);return x}function e(z){if(!z){return null}if(z.length==1){z="0"+z+":00"}if(z.length==2){z+=":00"}if(z.length==7||z.length==8){z=c(z)}var x=parseInt(z.substr(0,2),10);if(x==NaN){return null}if(x>23){return null}var y=z.substr(2,1);if(y!=":"){return null}var w=parseInt(z.substr(3,2),10);if(w==NaN){return null}if(w>59){return null}return new Date(1959,2,3,x,w,0,0)}function v(x,w){return w*Math.floor(x/w)+parseInt(x%w<(w/2)?0:w)}function q(y,w){var x=y.getHours()*60+y.getMinutes();var x=v(x,w);while(x>s){x=((x/w)-1)*w}return d(x)}function h(D,C,x,A,z){var w="";var y;w+='<select id="'+D+'" class="timepicker" data-native-menu="'+A.toString()+'">';for(var B=0;B<=s;B+=x){y=d(B);w+='<option value="'+y+'"';if(y==C){w+=" selected"}w+=">"+u(y,z)+"</option>"}w+="</select>";return w}function g(y,z){var A=l+y.id;var x=e(z);if(x){var w=q(x,y.interval);f("#"+A).val(w).selectmenu("refresh");y.value=u(w,y.value24Hour)}}function k(x){var w=x.id.substr(l.length);var y=f("#"+w).get(0).value24Hour;var z=u(f(x).val(),y);f("#"+w).get(0).value=z}f.fn.easytimepicker=function(x){var w=o(x);this.each(function(){this.id=this.id||++i;this.value24Hour=w.value24Hour;this.interval=w.interval;var A=f(this);var B=this.id;var z=l+B;var y=q(e(A.val())||new Date,w.interval);A.attr("style","display:none").after(h(z,y,w.interval,w.nativeMenu,w.display24Hour));f("label[for="+B+"]").attr("for",z);A.addClass(b);this.value=u(y,this.value24Hour)});f("select.timepicker").change(function(){k(this)});return this}})(jQuery);